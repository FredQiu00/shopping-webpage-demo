{"ast":null,"code":"var _jsxFileName = \"/Users/tianhonggao/Desktop/sample-react/webpage/src/Admin/Statistic.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\nimport { Pie } from 'react-chartjs-2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Stat = () => {\n  _s();\n  ChartJS.register(ArcElement, Tooltip, Legend);\n  const [allProducts, setAllProducts] = useState([]);\n  useEffect(() => {\n    const fetchDB = async () => {\n      try {\n        const response = await fetch('http://localhost:8000/api/products', {\n          method: 'GET'\n        });\n        const data = await response.json();\n        setAllProducts(data);\n      } catch (err) {\n        console.error('Failed to fetch products:', err);\n      }\n    };\n    fetchDB();\n  }, []);\n\n  // State to hold chart data\n  const [chartData, setChartData] = useState({\n    labels: [],\n    datasets: []\n  });\n  useEffect(() => {\n    const filteredProd = allProducts.filter(item => item.quantity !== 0);\n    const labels = filteredProd.map(item => item.prod_name);\n    const data = filteredProd.map(item => item.sold);\n\n    // Set chart data\n    setChartData({\n      labels: labels,\n      datasets: [{\n        data: data,\n        backgroundColor: ['rgba(220, 20, 60, 0.2)', 'rgba(255, 255, 0, 0.2)', 'rgba(255, 218, 185, 0.2)', 'rgba(240, 230, 140, 0.2)', 'rgba(34, 139, 34, 0.2)'\n        // Add more colors if you have many items\n        ],\n\n        borderColor: ['rgba(220, 20, 60, 1)', 'rgba(255, 255, 0, 1)', 'rgba(255, 218, 185, 1)', 'rgba(240, 230, 140, 1)', 'rgba(34, 139, 34, 1)'\n        // Add more colors if you have many items\n        ],\n\n        borderWidth: 0.5\n      }]\n    });\n  }, [allProducts]);\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      tooltip: {\n        callbacks: {\n          label: function (context) {\n            let total = context.dataset.data.reduce((a, b) => a + b, 0);\n            let value = context.raw;\n            let percentage = (value / total * 100).toFixed(2);\n            return context.label + ': ' + percentage + '%';\n          }\n        }\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: \"600px\",\n      height: \"600px\"\n    },\n    children: /*#__PURE__*/_jsxDEV(Pie, {\n      data: chartData,\n      options: options\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(Stat, \"58NHBtlAxoqQYaMGt5Ntvf+bkwo=\");\n_c = Stat;\nexport default Stat;\nvar _c;\n$RefreshReg$(_c, \"Stat\");","map":{"version":3,"names":["React","useEffect","useState","Chart","ChartJS","ArcElement","Tooltip","Legend","Pie","jsxDEV","_jsxDEV","Stat","_s","register","allProducts","setAllProducts","fetchDB","response","fetch","method","data","json","err","console","error","chartData","setChartData","labels","datasets","filteredProd","filter","item","quantity","map","prod_name","sold","backgroundColor","borderColor","borderWidth","options","responsive","maintainAspectRatio","plugins","tooltip","callbacks","label","context","total","dataset","reduce","a","b","value","raw","percentage","toFixed","style","width","height","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/tianhonggao/Desktop/sample-react/webpage/src/Admin/Statistic.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\nimport { Pie } from 'react-chartjs-2';\n\nconst Stat = () => {\n\n  ChartJS.register(ArcElement, Tooltip, Legend);\n  const [allProducts, setAllProducts] = useState([]);\n\n  useEffect(() => {\n    const fetchDB = async () => {\n      try {\n        const response = await fetch('http://localhost:8000/api/products', {\n          method: 'GET',\n        });\n        const data = await response.json();\n        setAllProducts(data);\n      } catch (err) {\n        console.error('Failed to fetch products:', err);\n      }\n    };\n    fetchDB();\n  }, []);\n\n  // State to hold chart data\n  const [chartData, setChartData] = useState({ labels: [], datasets: [] });\n\n  useEffect(() => {\n    const filteredProd = allProducts.filter(item => item.quantity !== 0);\n    const labels = filteredProd.map(item => item.prod_name);\n    const data = filteredProd.map(item => item.sold);\n\n    // Set chart data\n    setChartData({\n      labels: labels,\n      datasets: [{\n        data: data,\n        backgroundColor: [\n          'rgba(220, 20, 60, 0.2)',\n          'rgba(255, 255, 0, 0.2)',\n          'rgba(255, 218, 185, 0.2)',\n          'rgba(240, 230, 140, 0.2)',\n          'rgba(34, 139, 34, 0.2)',\n          // Add more colors if you have many items\n        ],\n        borderColor: [\n          'rgba(220, 20, 60, 1)',\n          'rgba(255, 255, 0, 1)',\n          'rgba(255, 218, 185, 1)',\n          'rgba(240, 230, 140, 1)',\n          'rgba(34, 139, 34, 1)',\n          // Add more colors if you have many items\n        ],\n        borderWidth: 0.5,\n      }],\n    });\n\n  }, [allProducts]);\n\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      tooltip: {\n        callbacks: {\n          label: function(context) {\n            let total = context.dataset.data.reduce((a, b) => a + b, 0);\n            let value = context.raw;\n            let percentage = ((value/total) * 100).toFixed(2);\n            return context.label + ': ' + percentage + '%';\n          }\n        }\n      }\n    }\n  }\n\n  return (\n    <div style={{width: \"600px\", height: \"600px\"}}>\n      <Pie data={chartData} options={options}/>\n    </div>\n  );\n};\n\nexport default Stat;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}