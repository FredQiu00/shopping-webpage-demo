{"ast":null,"code":"var _jsxFileName = \"/Users/tianhonggao/Desktop/sample-react/webpage/src/Admin/Statistic.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend, BarElement, CategoryScale } from 'chart.js';\nimport { Bar, Pie } from 'react-chartjs-2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(ArcElement, Tooltip, Legend, BarElement, CategoryScale);\nconst Stat = () => {\n  _s();\n  const [allProducts, setAllProducts] = useState([]);\n  useEffect(() => {\n    fetchDB();\n  }, []);\n  const fetchDB = async () => {\n    try {\n      const response = await fetch('http://localhost:8000/api/products', {\n        method: 'GET'\n      });\n      let data = await response.json();\n      setAllProducts(data.filter(item => item.quantity !== 0));\n    } catch (err) {\n      console.error('Failed to fetch products:', err);\n    }\n  };\n  const [barChartData, setBarChartData] = useState({\n    labels: [],\n    datasets: []\n  });\n  const [pieChartData, setPieChartData] = useState({\n    labels: [],\n    datasets: []\n  });\n  useEffect(() => {\n    const sortedProd = [...allProducts].sort((a, b) => b.sold - a.sold);\n    const labels = sortedProd.map(item => item.prod_name);\n    const data = sortedProd.map(item => item.sold);\n    const colorMap = {\n      \"Apple\": \"rgba(255, 0, 0, 0.6)\",\n      \"banana\": \"rgba(255, 255, 0, 0.6)\",\n      \"peach\": \"rgba(255, 105, 180, 0.6)\",\n      \"pineapple\": \"rgba(255, 223, 0, 0.6)\",\n      \"watermelon\": \"rgba(60, 179, 113, 0.6)\"\n      // add other items here...\n    };\n\n    // Set bar chart data\n    setBarChartData({\n      labels: labels,\n      datasets: [{\n        label: 'Sold',\n        data: data,\n        backgroundColor: 'rgba(75, 192, 192, 0.2)',\n        borderColor: 'rgba(75, 192, 192, 1)',\n        borderWidth: 1\n      }]\n    });\n\n    // Set pie chart data\n    setPieChartData({\n      labels: labels,\n      datasets: [{\n        label: 'Sold',\n        data: data,\n        backgroundColor: data.map(item => colorMap[item.prod_name] || \"rgba(75, 192, 192, 0.6)\"),\n        borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)'\n        // Add more colors if you have many items\n        ],\n\n        borderWidth: 1\n      }]\n    });\n  }, [allProducts]);\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      tooltip: {\n        callbacks: {\n          label: function (context) {\n            let total = context.dataset.data.reduce((a, b) => a + b, 0);\n            let value = context.raw;\n            let percentage = (value / total * 100).toFixed(2);\n            return context.label + ': ' + percentage + '%';\n          }\n        }\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-between'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"600px\",\n        height: \"600px\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Bar, {\n        data: barChartData,\n        options: options\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"600px\",\n        height: \"600px\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Pie, {\n        data: pieChartData,\n        options: options\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 5\n  }, this);\n};\n_s(Stat, \"93KboKqjZH4gU36llPcpy08LPKI=\");\n_c = Stat;\nexport default Stat;\nvar _c;\n$RefreshReg$(_c, \"Stat\");","map":{"version":3,"names":["React","useEffect","useState","Chart","ChartJS","ArcElement","Tooltip","Legend","BarElement","CategoryScale","Bar","Pie","jsxDEV","_jsxDEV","register","Stat","_s","allProducts","setAllProducts","fetchDB","response","fetch","method","data","json","filter","item","quantity","err","console","error","barChartData","setBarChartData","labels","datasets","pieChartData","setPieChartData","sortedProd","sort","a","b","sold","map","prod_name","colorMap","label","backgroundColor","borderColor","borderWidth","options","responsive","maintainAspectRatio","plugins","tooltip","callbacks","context","total","dataset","reduce","value","raw","percentage","toFixed","style","display","justifyContent","children","width","height","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/tianhonggao/Desktop/sample-react/webpage/src/Admin/Statistic.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend, BarElement, CategoryScale } from 'chart.js';\nimport { Bar, Pie } from 'react-chartjs-2';\n\nChartJS.register(ArcElement, Tooltip, Legend, BarElement, CategoryScale);\n\nconst Stat = () => {\n\n  const [allProducts, setAllProducts] = useState([]);\n\n  useEffect(() => {\n    fetchDB();\n  }, []);\n\n  const fetchDB = async () => {\n    try {\n      const response = await fetch('http://localhost:8000/api/products', {\n        method: 'GET',\n      });\n      let data = await response.json();\n      setAllProducts(data.filter(item => item.quantity !== 0));\n    } catch (err) {\n      console.error('Failed to fetch products:', err);\n    }\n  };\n\n  const [barChartData, setBarChartData] = useState({ labels: [], datasets: [] });\n  const [pieChartData, setPieChartData] = useState({ labels: [], datasets: [] });\n\n  useEffect(() => {\n    const sortedProd = [...allProducts].sort((a, b) => b.sold - a.sold);\n    const labels = sortedProd.map(item => item.prod_name);\n    const data = sortedProd.map(item => item.sold);\n    const colorMap = {\n      \"Apple\": \"rgba(255, 0, 0, 0.6)\",\n      \"banana\": \"rgba(255, 255, 0, 0.6)\",\n      \"peach\": \"rgba(255, 105, 180, 0.6)\",\n      \"pineapple\": \"rgba(255, 223, 0, 0.6)\",\n      \"watermelon\": \"rgba(60, 179, 113, 0.6)\"\n      // add other items here...\n    };\n\n    // Set bar chart data\n    setBarChartData({\n      labels: labels,\n      datasets: [{\n        label: 'Sold',\n        data: data,\n        backgroundColor: 'rgba(75, 192, 192, 0.2)',\n        borderColor: 'rgba(75, 192, 192, 1)',\n        borderWidth: 1,\n      }],\n    });\n\n    // Set pie chart data\n    setPieChartData({\n      labels: labels,\n      datasets: [{\n        label: 'Sold',\n        data: data,\n        backgroundColor: data.map(item => colorMap[item.prod_name] || \"rgba(75, 192, 192, 0.6)\"),\n        borderColor: [\n          'rgba(255, 99, 132, 1)',\n          'rgba(54, 162, 235, 1)',\n          'rgba(255, 206, 86, 1)',\n          'rgba(75, 192, 192, 1)',\n          'rgba(153, 102, 255, 1)',\n          // Add more colors if you have many items\n        ],\n        borderWidth: 1,\n      }],\n    });\n  }, [allProducts]);\n\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      tooltip: {\n        callbacks: {\n          label: function(context) {\n            let total = context.dataset.data.reduce((a, b) => a + b, 0);\n            let value = context.raw;\n            let percentage = ((value/total) * 100).toFixed(2);\n            return context.label + ': ' + percentage + '%';\n          }\n        }\n      }\n    }\n  }\n\n  return (\n    <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n      <div style={{width: \"600px\", height: \"600px\"}}>\n        <Bar data={barChartData} options={options} />\n      </div>\n      <div style={{width: \"600px\", height: \"600px\"}}>\n        <Pie data={pieChartData} options={options} />\n      </div>\n    </div>\n  );\n};\n\nexport default Stat;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}